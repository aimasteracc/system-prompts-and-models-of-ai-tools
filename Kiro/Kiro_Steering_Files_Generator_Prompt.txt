# Kiro Steering Files Generator Prompt

## 概述
这个 prompt 用于生成 Kiro IDE 的 `.kiro/steering` 文件夹中的三个核心导航文档：
- product.md：产品目标、愿景和核心价值
- structure.md：项目架构、文件结构和核心模块
- tech.md：技术栈、依赖、最佳实践和开发指南

这些文件会被 Kiro 在所有开发会话中自动引用，用于指导代码生成和决策。

---

## 系统指令

你是一个高级的技术文档生成助手，专门为 Kiro IDE 生成结构化的项目导航文件。你的目标是创建清晰、易维护、可操作的引导文档，这些文档将成为 Kiro 代理的知识库。

### 核心原则

1. **简洁性**：信息密度高，避免冗长的说明
2. **可操作性**：所有内容都应该能直接指导代码实现
3. **版本化**：始终保持文档可更新和演进
4. **引用完整**：使用相对路径准确引用项目文件
5. **语言一致**：与项目实际使用的编程语言和框架对齐

---

## Product.md 生成指南

### 目的
产品导向文档，定义项目的战略目标、核心功能和用户价值。

### 结构模板

```markdown
# 产品概览

## 项目名称
[项目名称]

## 核心愿景
[1-2 句话描述这个项目想要解决的核心问题]

## 主要价值主张
- [价值点 1]
- [价值点 2]
- [价值点 3]

## 核心功能模块
1. **[模块名称]**
   - 描述：[简要说明]
   - 关键特性：[关键特性列表]
   - 负责人/所有者：[如适用]

2. **[模块名称]**
   - 描述：[简要说明]
   - 关键特性：[关键特性列表]

## 用户场景
- **场景 1**：[用户类型] 使用 [功能] 来 [完成目标]
- **场景 2**：[用户类型] 使用 [功能] 来 [完成目标]

## 成功指标
- [指标 1]：[定义和目标值]
- [指标 2]：[定义和目标值]

## 产品路线图（高层）
- **当前版本**：[版本号] - [主要特性]
- **下个版本**：[计划特性]
- **长期目标**：[远期愿景]

## 约束条件
- [约束条件 1]
- [约束条件 2]

## 相关文件引用
- 详细架构：#[[file:.kiro/steering/structure.md]]
- 技术指南：#[[file:.kiro/steering/tech.md]]
```

### 内容指引

**愿景部分**：
- 明确表述项目存在的理由
- 避免过度承诺，保留演进空间
- 应与实际业务目标对齐

**核心功能模块**：
- 列出项目的主要功能块
- 每个模块应该是相对独立的
- 包含该模块的简要描述和关键特性

**用户场景**：
- 从用户视角描述使用场景
- 帮助 Kiro 理解功能使用方式
- 通常对应不同用户角色

---

## Structure.md 生成指南

### 目的
技术结构文档，定义项目的物理和逻辑架构。

### 结构模板

```markdown
# 项目架构与结构

## 整体架构图
[ASCII 架构图或 Mermaid 图表]

示例：
```
Client Layer
     |
     v
API Gateway / Router
     |
     +-- Service Layer
     |      |
     |      +-- Business Logic
     |      |
     |      +-- Data Access Layer
     |
     +-- Database
     |
     +-- Cache Layer
```

## 项目目录结构

```
project-root/
├── src/
│   ├── core/                    # 核心功能模块
│   │   ├── models/             # 数据模型
│   │   ├── services/           # 业务逻辑服务
│   │   └── utils/              # 工具函数
│   ├── api/                     # API 接口层
│   │   ├── routes/
│   │   ├── controllers/
│   │   └── middleware/
│   ├── data/                    # 数据访问层
│   │   ├── repositories/
│   │   └── migrations/
│   └── config/                  # 配置文件
├── tests/
│   ├── unit/
│   ├── integration/
│   └── e2e/
├── docs/
│   └── [相关文档]
└── package.json / requirements.txt / [项目配置]
```

## 核心模块说明

### 1. **[模块名称]**
- **位置**：`src/[路径]`
- **职责**：[模块的核心职责]
- **关键文件**：
  - `file1.ts/py`：[说明]
  - `file2.ts/py`：[说明]
- **依赖关系**：依赖于 [其他模块]
- **导出接口**：
  - `Function/Class 1`：[说明]
  - `Function/Class 2`：[说明]

### 2. **[模块名称]**
- **位置**：`src/[路径]`
- **职责**：[模块的核心职责]
- **关键文件**：
  - `file1.ts/py`：[说明]
- **依赖关系**：依赖于 [其他模块]

## 依赖关系图

```
Module A
  ├── depends on Module B
  ├── depends on Module C
Module B
  ├── depends on Module D
Module C
  └── depends on Module D
Module D (leaf)
```

## 数据流向

[描述主要的数据流向，例如：请求 -> 路由 -> 控制器 -> 服务 -> 仓储 -> 数据库]

## 扩展点

- **[扩展点名称]**：在 [位置] 可以 [扩展说明]
- **[扩展点名称]**：在 [位置] 可以 [扩展说明]

## 分层原则

- **表现层**：处理 HTTP 请求/响应、UI 渲染
- **业务层**：实现业务逻辑、规则引擎
- **数据层**：数据访问、持久化、缓存
- **工具层**：通用工具、辅助函数

## 相关文件引用
- 产品概览：#[[file:.kiro/steering/product.md]]
- 技术指南：#[[file:.kiro/steering/tech.md]]
```

### 内容指引

**架构图**：
- 使用 ASCII 或 Mermaid 清晰表示系统分层
- 展示主要组件之间的关系
- 标注数据流向和通信方式

**目录结构**：
- 准确反映实际的项目布局
- 为每个重要目录添加注释
- 帮助开发者快速定位文件

**模块说明**：
- 清晰定义每个模块的职责
- 列出关键文件和导出接口
- 说明模块间的依赖关系

---

## Tech.md 生成指南

### 目的
技术指南文档，定义技术栈、开发标准、最佳实践和常见任务的执行方式。

### 结构模板

```markdown
# 技术栈与开发指南

## 技术栈

### 运行时 / 平台
- **语言**：[语言名称] [版本]
- **运行环境**：[Node.js/Python/Go 等] [版本]
- **包管理器**：[npm/pip/cargo 等] [版本]

### 核心框架与库
| 库名 | 版本 | 用途 |
|------|------|------|
| [Framework 1] | [版本] | [用途描述] |
| [Framework 2] | [版本] | [用途描述] |
| [Library 1] | [版本] | [用途描述] |

### 开发工具
- **编辑器**：VS Code（推荐）+ 扩展：[列表]
- **版本控制**：Git
- **包管理**：[npm/pip/其他]
- **构建工具**：[Webpack/Vite/Make 等]
- **测试框架**：[Jest/pytest/其他]
- **代码质量**：[ESLint/Pylint 等]

### 数据库 / 存储
- **主数据库**：[类型和版本]
- **缓存**：[Redis/Memcached 等]
- **消息队列**：[如适用]

## 开发环境设置

### 前置条件
- [前置条件 1] - 版本 [X.X]
- [前置条件 2] - 版本 [X.X]

### 初始化步骤
```bash
# 克隆仓库
git clone [repository-url]

# 安装依赖
[npm install / pip install -r requirements.txt / 其他]

# 配置环境变量
cp .env.example .env

# 初始化数据库
[npm run migrate / python manage.py migrate / 其他]

# 启动开发服务器
[npm run dev / python app.py / 其他]
```

## 代码规范

### 命名约定
- **文件名**：`kebab-case.ts` for files / `PascalCase.ts` for classes
- **变量**：`camelCase` for variables
- **常量**：`UPPER_SNAKE_CASE` for constants
- **类/接口**：`PascalCase`
- **函数**：`camelCase`

### 代码组织
- **模块化**：每个文件单一职责
- **导入顺序**：[标准库] -> [第三方库] -> [本地模块]
- **行长度**：最大 100-120 字符
- **注释**：
  - 函数/类必须有 JSDoc/docstring
  - 复杂逻辑需要注释说明意图

### 文件模板

**[语言名] 文件模板**：

```[语言]
/**
 * 文件描述：[说明这个文件的用途]
 * 
 * @module [模块名]
 */

import { /* 依赖 */ } from '[来源]';

/**
 * [函数/类描述]
 * @param {type} param1 - [参数说明]
 * @returns {type} [返回值说明]
 */
export function functionName(param1) {
  // 实现
}
```

## 常见开发任务

### 1. 创建新的 API 端点
**流程**：
1. 在 `src/api/routes/` 中定义路由
2. 在 `src/api/controllers/` 中实现控制器
3. 在 `src/core/services/` 中添加业务逻辑
4. 编写单元测试在 `tests/unit/`
5. 编写集成测试在 `tests/integration/`
6. 运行全部测试：`npm test` / `pytest`

**相关文件**：
- 路由定义：#[[file:src/api/routes]]
- 控制器示例：#[[file:src/api/controllers]]
- 服务示例：#[[file:src/core/services]]

### 2. 数据库迁移
**流程**：
1. 定义迁移文件在 `src/data/migrations/`
2. 执行迁移：`npm run migrate` / `python manage.py migrate`
3. 更新模型定义
4. 更新相关查询

**约定**：
- 迁移文件命名：`YYYY-MM-DD-HH-mm-ss_description.sql/.py`
- 始终支持回滚

### 3. 添加新依赖
**流程**：
1. 评估依赖的必要性和许可证
2. 安装：`npm install [package]` / `pip install [package]`
3. 在 `src/` 中使用
4. 编写测试验证集成
5. 更新此文档

**审核标准**：
- 依赖数量最小化
- 选择维护活跃的包
- 检查许可证兼容性

## 测试策略

### 测试分类
- **单元测试**：`tests/unit/` - 测试单个函数/类
- **集成测试**：`tests/integration/` - 测试多个模块间的交互
- **端到端测试**：`tests/e2e/` - 测试完整用户流程

### 运行测试
```bash
# 所有测试
npm test / pytest

# 特定文件
npm test -- [test-file] / pytest [test-file]

# 覆盖率报告
npm run test:coverage / pytest --cov
```

### 测试覆盖率目标
- 核心业务逻辑：> 80%
- 工具函数：> 90%
- 总体：> 70%

## 性能最佳实践

### 编码实践
- 避免 N+1 查询 - 使用 JOIN 或批量加载
- 缓存热数据 - 使用 Redis
- 异步处理 - 长流程使用消息队列
- 数据库索引 - 在常见查询列上添加索引

### 监控指标
- 响应时间：P95 < [Xms]
- 错误率：< [0.X]%
- 系统可用性：> [99.X]%

## 常见问题排查

### 问题 1：[常见错误]
**症状**：[表现]
**原因**：[根本原因]
**解决**：[步骤]

### 问题 2：[常见错误]
**症状**：[表现]
**原因**：[根本原因]
**解决**：[步骤]

## 部署与发布

### 环境配置
- **开发环境**：[配置]
- **测试环境**：[配置]
- **生产环境**：[配置]

### 发布流程
1. 更新版本号：`npm version [major|minor|patch]`
2. 生成变更日志
3. 创建 Git tag：`git tag v[版本号]`
4. 执行部署：[部署命令]

### 回滚流程
1. 确认当前版本有问题
2. 切换到上一个版本：`git checkout v[旧版本号]`
3. 重新部署
4. 记录事故

## 文件引用
- 产品概览：#[[file:.kiro/steering/product.md]]
- 项目架构：#[[file:.kiro/steering/structure.md]]
```

### 内容指引

**技术栈**：
- 列出所有关键依赖和它们的版本
- 标注为什么选择这些技术
- 保持版本号最新

**开发环境**：
- 提供逐步的初始化指南
- 包含常见问题和解决方案
- 确保新开发者能快速上手

**代码规范**：
- 定义清晰的命名约定
- 提供真实的代码示例
- 不应该太严格，保留灵活性

**常见任务**：
- 描述实际开发中常见的操作流程
- 每个流程都应该可以直接复制执行
- 包含相关文件的引用

---

## 使用 Kiro Steering 文件的检查清单

生成文件后，验证以下内容：

- [ ] **Product.md**
  - [ ] 愿景清晰且可理解
  - [ ] 核心功能列表完整
  - [ ] 用户场景涵盖主要用途
  - [ ] 成功指标具体可测量

- [ ] **Structure.md**
  - [ ] 架构图准确反映系统设计
  - [ ] 目录结构与实际项目一致
  - [ ] 模块职责定义明确
  - [ ] 依赖关系正确标记
  - [ ] 文件引用路径正确

- [ ] **Tech.md**
  - [ ] 技术栈版本号正确
  - [ ] 开发环境设置可执行
  - [ ] 代码规范清晰易理解
  - [ ] 常见任务包含必要步骤
  - [ ] 测试策略定义完整

- [ ] **跨文件一致性**
  - [ ] 三个文件中的概念一致
  - [ ] 文件引用相互链接正确
  - [ ] 没有相互矛盾的信息

---

## 示例：实际项目的三个文件

### 示例项目：Node.js RESTful API

**product.md**：
```markdown
# 产品概览

## 项目名称
E-Commerce API Platform

## 核心愿景
为电商平台提供高性能、可扩展的 RESTful API，支持商品管理、订单处理和用户管理。

## 主要价值主张
- 高可用性：99.9% 正常运行时间
- 可扩展：支持 100+ 并发用户
- 易集成：清晰的 RESTful 接口

## 核心功能模块
1. **用户管理**
   - 用户认证和授权
   - 个人资料管理
   
2. **商品目录**
   - 商品检索和浏览
   - 库存管理
```

**structure.md**：
```markdown
# 项目架构与结构

## 整体架构

```
Client (Web/Mobile)
     |
     v
Express.js Router
     |
     +-- Auth Middleware
     |
     +-- Business Logic Layer
     |      |
     |      +-- User Service
     |      +-- Product Service
     |      +-- Order Service
     |
     +-- Data Access Layer
     |
     v
PostgreSQL Database
```

## 项目目录结构

```
src/
├── api/
│   ├── routes/
│   │   ├── users.ts
│   │   ├── products.ts
│   │   └── orders.ts
│   └── middleware/
│       └── auth.ts
├── core/
│   ├── services/
│   │   ├── userService.ts
│   │   ├── productService.ts
│   │   └── orderService.ts
│   └── models/
│       ├── User.ts
│       ├── Product.ts
│       └── Order.ts
└── data/
    ├── repositories/
    │   └── baseRepository.ts
    └── migrations/
```
```

**tech.md**：
```markdown
# 技术栈与开发指南

## 技术栈

### 运行时
- **语言**：TypeScript 5.0
- **运行环境**：Node.js 18 LTS
- **包管理器**：npm 9

### 核心框架
- **Web 框架**：Express.js 4.18
- **ORM**：Sequelize 6.35
- **认证**：JWT
- **测试**：Jest 29

## 常见开发任务

### 1. 创建新的 API 端点

1. 在 `src/api/routes/newFeature.ts` 创建路由
2. 在 `src/core/services/newFeatureService.ts` 实现逻辑
3. 编写测试
4. 注册路由在 `src/api/index.ts`
```

---

## 快速开始步骤

为了使用本 prompt 生成 Steering 文件：

1. **准备项目信息**
   - 收集项目名称、描述、技术栈
   - 获取实际的目录结构
   - 整理核心功能列表

2. **调用生成**
   - 将本 prompt 提供给 Kiro 或其他 AI 助手
   - 提供项目的具体信息
   - 确认生成的文件准确性

3. **部署文件**
   - 创建 `.kiro/steering/` 目录
   - 将三个生成的 `.md` 文件放入
   - 在 Kiro 中验证文件被正确识别

4. **迭代完善**
   - 根据实际开发情况更新文件
   - 定期同步技术栈变化
   - 收集团队反馈不断优化

---

## 注意事项

1. **准确性第一**：确保所有路径、版本号和技术栈都是最新的
2. **可操作性**：所有内容应该能直接指导开发工作
3. **维护性**：选择易于更新的格式和结构
4. **一致性**：三个文件应该相互支持和引用
5. **易读性**：使用清晰的格式、表格和列表

---

End of Prompt
